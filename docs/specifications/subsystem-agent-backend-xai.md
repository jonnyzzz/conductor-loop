# Agent Backend: xAI

## Overview
Defines the native xAI (Grok) backend integration for run-agent. xAI is invoked via REST API (not CLI wrappers).

## Goals
- Provide a stable adapter for xAI-backed agent runs.
- Stream output progressively for real-time monitoring.

## REST API Interaction
- **Base URL**: `https://api.x.ai` (default).
- **Endpoint**: `/v1/chat/completions`.
- **Model**: `grok-4` (default).
- **Method**: `POST`.
- **Headers**:
    - `Authorization: Bearer <token>`
    - `Content-Type: application/json`
    - `Accept: text/event-stream`
    - `User-Agent: conductor-loop/xai`

## I/O Contract
- **Input**: Prompt text (from prompt.md).
- **Output**: Plain text response written to stdout (captured to `agent-stdout.txt`). `output.md` is generated by the runner from the captured stdout.
- **Streaming**:
    - **Protocol**: Server-Sent Events (SSE).
    - **Behavior**: Parse SSE `data:` events; extract content from `choices[0].delta.content`; writes to stdout.

## Environment / Config
- Tokens/credentials configured in `config.yaml`:
  ```yaml
  agents:
    - type: xai
      token: "..."                          # Inline token
      # OR:
      token_file: "~/.config/xai/token"     # File path
  ```
- Runner automatically injects token as `XAI_API_KEY` environment variable.
- REST adapter also honors environment overrides:
  - `XAI_API_KEY`
  - `XAI_BASE_URL`, `XAI_API_BASE`, `XAI_API_ENDPOINT`
  - `XAI_MODEL`

## Implementation Status
- **Status**: Active / Production.
- **Go Package**: `internal/agent/xai`.
- **Runner Logic**: `isRestAgent("xai")` returns true; instantiated via `xai.NewAgent`.
- **Type String**: `"xai"`.
