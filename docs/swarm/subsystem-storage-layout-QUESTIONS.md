# Storage & Data Layout - Questions

- Q: What exact timestamp format/timezone should be used for all <timestamp> segments to ensure lexical sort == chronological?
  Proposed default: 
  A: UTC with YYYYMMDD-HHMMSSMMMM-PID (path-safe, sortable; UTC by convention).

- Q: What format should run_id take (ULID/UUIDv7/etc.) and who generates it?
  Proposed default: ULID generated by the runner; used in run folder names and message bus entries.
  A: RunId is generated by run-agent automatically, use UTC with YYYYMMDD-HHMMSSMMMM-PID as sufix

- Q: What are allowed characters/length limits for project IDs and task slugs, and what is the collision strategy?
  Proposed default: slugify to lowercase [a-z0-9-], max 48 chars; on collision append -<4char> hash.
  A: Java Identifier rules. No limit on project ID length.

- Q: What is the intended content/producer for output.md vs agent-stdout.txt/agent-stderr.txt, and which should the UI show by default?
  A: output.md is the final agent response; stdout/stderr are raw streams; UI defaults to output.md with a raw-logs toggle.

- Q: What is the write protocol for root-owned files (TASK_STATE.md, OWNERSHIP.md), and should updates be atomic?
  A: Only root agent writes; use temp write + atomic rename; last writer wins.

- Q: Do FACT files require a standard header (YAML front matter with scope/run_id), or is free-form Markdown acceptable?
  Proposed default: YAML front matter with created_at, scope (task/project), run_id, title; body Markdown.
  A: yes, yaml front matter required. Refer to message bus entry.

- Q: Where should per-project and per-task config overrides live on disk, and what filenames are standard?
  Proposed default: PROJECT-CONFIG.json5 in project root and TASK-CONFIG.json5 in task folder; override-only keys allowed.
  A: No such files needed. we only have os-wide config under user home. The rest are readable files under each folder.

- Q: What is the retention policy for run folders and large artifacts (output, stdout/stderr)?
  Proposed default: Keep last N runs per task (default 10); older runs archived or pruned on new runs; configurable per project.
  A: No need to retain/cleanup run folders.

- Q: Should there be explicit size limits for output.md, TASK_STATE.md, and FACT files?
  Proposed default: Soft limits with warnings (output 5MB, state 1MB, facts 2MB); larger content moved to attachments.
  A: No limit

- Q: Should symlinks or hardlinks be allowed inside the storage tree, and how are they handled during cleanup?
  Proposed default: Disallow symlinks outside storage root; hardlinks allowed but tracked for deduplication.
  A: Not allowed.

- Q: How are storage path conflicts resolved when multiple runners/hosts use the same storage root?
  Proposed default: Each runner has host_id; storage includes <host_id>/runs/<run_id>; UI aggregates across hosts.
  A: runs folders are per project per task, no host_id.
