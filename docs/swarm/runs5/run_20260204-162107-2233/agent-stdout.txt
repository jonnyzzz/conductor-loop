I will list the current directory to verify file names and then read the content of the specified files (`ideas.md`, `subsystem-agent-protocol.md`, `subsystem-agent-protocol-QUESTIONS.md`, `TIPICS.md`, `SUBSYSTEMS.md`, and the history file) to analyze the current state of the Agent Protocol & Governance design.

I have analyzed the Agent Protocol & Governance scope. I am Gemini, so I have not performed Perplexity verification, but the technical choices (Go binary, SSE, HCL) align with standard systems programming practices.

### 1. External Facts Check
*   **SSE vs WS:** SSE is suitable for the one-way "monitoring" stream from runner to UI.
*   **Go Binary:** Using a single Go binary (`run-agent`) for the runner/CLI is consistent with the `TIPICS.md` decision and simplifies distribution compared to shell scripts.

### 2. Spec Updates
**target: subsystem-agent-protocol.md**
*   **Delegation & Blocking:** Explicitly state that `run-agent` calls are **synchronous/blocking** for the calling agent. The parent process waits for the child to exit to read `output.md`.
    *   *Rationale:* Simplifies agent logic (synchronous control flow) and aligns with the "Review" -> "Plan" -> "Act" loop.
*   **Git Operations:** Strengthen "Git Safety" to "Git Mandates".
    *   Agents MUST run `git status` before committing.
    *   Agents MUST NOT use `git commit -a` or wildcard stages that might include untracked/unintended files.
    *   Agents MUST explicitly `git add <file>` for only the files they modified.
*   **Failure Handling:** Define that agents must check the exit code of the `run-agent` command.
    *   `0`: Success (read `output.md`).
    *   `1`: Task Failure (read `output.md` or `stderr` for reason).
    *   `>1`: System Error/Crash (retry or fail).

### 3. Questions to Remove/Resolve
**target: subsystem-agent-protocol-QUESTIONS.md**

*   **Q:** When a parent agent delegates to a sub-agent, must the parent block until the child completes, or can it exit and rely on Ralph to manage completion?
    *   **Resolution:** **Parent blocks.** The `run-agent` CLI command is synchronous. This ensures the parent can synthesize the child's results into its own output immediately. If the parent crashes, Ralph handles the restart, but the "happy path" is blocking.

*   **Q:** When should the system move from root-agent polling to a dedicated message-bus polling service?
    *   **Resolution:** **Post-MVP.** The current spec assigns polling responsibility to the root agent (and the `run-agent` tool during execution). A dedicated service will be added only if message volume becomes a bottleneck.

### 4. New Open Questions
**target: subsystem-agent-protocol-QUESTIONS.md**

*   **Q:** How does a parent agent distinguish between a child's *inability to complete the task* (logic failure) vs. a *runtime crash*?
    *   **Proposed default:** Exit code `1` implies "Task attempted but failed" (check `output.md`). Exit code `!= 0` and `!= 1` implies system crash/kill.
    *   **A:** TBD.

### 5. New Docs/Topics Suggested
*   (None required at this stage. The Git mandates fit within the protocol doc.)
