I will begin by reading the relevant documentation files and the git history for the storage subsystem to understand the current state and evolution of the design.

Here is the review of the Storage & Data Layout subsystem.

### 1) External facts check
*   **Timestamp Format:** `YYYYMMDD-HHMMSSMMMM-PID` is non-standard. `MMMM` typically denotes the full month name in date formatting patterns. Given the answered question ("Milliseconds is enough"), this likely represents milliseconds. Standard notation is usually `SSS` or `fff`.
*   **Java Identifier:** A well-defined standard for `project_id`.

### 2) Spec updates
**`subsystem-storage-layout.md`**
*   **Update `run-info.yaml` format:**
    *   Add `version: 1` (integer) to the list of Required fields to support future schema evolution.
*   **Update `Constraints` section:**
    *   Add: "Encoding: All text files (Markdown, YAML, JSON, logs) must be strictly UTF-8 encoded without BOM."
*   **Update `Naming Conventions` section:**
    *   Clarify the timestamp format: "Timestamp format (UTC): `YYYYMMDD-HHMMSSsss-PID` (where `sss` is milliseconds)."
*   **Update `TASK_STATE.md` section:**
    *   Explicitly state: "Sub-agents must NOT write to this file directly; they should report status via the Message Bus or their output."
*   **Update `ATTACH-*.ext` section:**
    *   Add naming rule: "Name segment must be sanitized (slugified) similar to task slugs."

### 3) Questions to remove/resolve
**`subsystem-storage-layout-QUESTIONS.md`**
*   **Q:** Is UTF-8 encoding strictly enforced...?
    *   **Resolution:** Yes. Added to spec.
*   **Q:** Do we need a schema/version field in run-info.yaml...?
    *   **Resolution:** Yes. Added `version: 1` to spec.

### 4) New open questions
**`subsystem-storage-layout-QUESTIONS.md`**
*   **Q:** Should `run-agent` automatically git-init and commit changes in `~/run-agent`?
    *   **Context:** `ideas.md` suggests: "The location is heavily recommended to be under local git (and if so it commit/push often)".
    *   **Proposed default:** No automatic git integration in MVP; relying on user to manage git if desired.
    *   **A:** TBD.
*   **Q:** What are the exact sanitization rules for `<name>` in `FACT-<timestamp>-<name>.md` and `ATTACH-<timestamp>-<name>.<ext>`?
    *   **Proposed default:** Same as task slugs: lowercase `[a-z0-9-]`, max 48 chars.
    *   **A:** TBD.

### 5) New docs/topics suggested
*   None.
